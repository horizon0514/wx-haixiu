{"version":3,"sources":["pages/index/index.js"],"names":["app","getApp","Page","data","title","userInfo","currentPage","topics","onLoad","console","log","getUserInfo","then","setData","info","catch","fetchData","self","limit","start","wx","showLoading","request","url","header","success","res","hideLoading","docs","fail","err","showToast","duration","fetchPre","fetchNext","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":";;AAAA;AACA,IAAMA,MAAMC,QAAZ;;AAEA;AACAC,KAAK;AACH;;;AAGAC,QAAM;AACJC,WAAO,YADH;AAEJC,cAAU,EAFN;AAGJC,iBAAa,CAHT;AAIJC,YAAQ;AAJJ,GAJH;AAUH;;;AAGAC,QAbG,oBAaO;AAAA;;AACRC,YAAQC,GAAR,CAAY,+BAAZ;AACA;AACAV,QAAIW,WAAJ,GACGC,IADH,CACQ;AAAA,aAAQ,MAAKC,OAAL,CAAa,EAAER,UAAUS,IAAZ,EAAb,CAAR;AAAA,KADR,EAEGC,KAFH,CAESN,QAAQK,IAFjB;AAGA,SAAKE,SAAL;AACD,GApBE;;AAqBH;;;;AAIAA,WAzBG,uBAyBU;AACX,QAAMC,OAAO,IAAb;AACA,QAAMC,QAAQ,EAAd;AACA,QAAMC,QAAQF,KAAKd,IAAL,CAAUG,WAAV,GAAwBY,KAAtC;;AAEAE,OAAGC,WAAH,CAAe;AACbjB,aAAO;AADM,KAAf;AAGAgB,OAAGE,OAAH,CAAW;AACTC,2DAAmDJ,KAAnD,eAAkED,KADzD;AAETM,cAAQ;AACN,wBAAgB;AADV,OAFC;AAKTC,eAAS,iBAAUC,GAAV,EAAe;AACtBN,WAAGO,WAAH;AACAV,aAAKJ,OAAL,CAAa;AACXN,kBAAQmB,IAAIvB,IAAJ,CAASyB;AADN,SAAb;AAGD,OAVQ;AAWTC,YAAM,cAAUC,GAAV,EAAe;AACnBV,WAAGO,WAAH;AACAP,WAAGW,SAAH,CAAa;AACX3B,iBAAO,MADI;AAEX4B,oBAAU;AAFC,SAAb;AAID;;AAjBQ,KAAX;AAoBD,GArDE;AAsDHC,UAtDG,sBAsDS;AACV,QAAMhB,OAAO,IAAb;AACA,QAAGA,KAAKd,IAAL,CAAUG,WAAV,GAAsB,CAAzB,EAA4B;AAC1BW,WAAKJ,OAAL,CAAa;AACXP,qBAAaW,KAAKd,IAAL,CAAUG,WAAV,GAAwB;AAD1B,OAAb;AAGAW,WAAKD,SAAL;AACD;AACF,GA9DE;AA+DHkB,WA/DG,uBA+DU;AACXzB,YAAQC,GAAR,CAAY,MAAZ;AACA,QAAMO,OAAO,IAAb;AACAA,SAAKJ,OAAL,CAAa;AACXP,mBAAaW,KAAKd,IAAL,CAAUG,WAAV,GAAwB;AAD1B,KAAb;AAGAW,SAAKD,SAAL;AACD,GAtEE;;AAuEH;;;AAGAmB,SA1EG,qBA0EQ;AACT1B,YAAQC,GAAR,CAAY,gCAAZ;AACD,GA5EE;;AA6EH;;;AAGA0B,QAhFG,oBAgFO;AACR3B,YAAQC,GAAR,CAAY,+BAAZ;AACD,GAlFE;;AAmFH;;;AAGA2B,QAtFG,oBAsFO;AACR5B,YAAQC,GAAR,CAAY,+BAAZ;AACD,GAxFE;;AAyFH;;;AAGA4B,UA5FG,sBA4FS;AACV7B,YAAQC,GAAR,CAAY,iCAAZ;AACD,GA9FE;;AA+FH;;;AAGA6B,mBAlGG,+BAkGkB;AACnB9B,YAAQC,GAAR,CAAY,0CAAZ;AACD;AApGE,CAAL","file":"index.js","sourcesContent":["// 获取全局应用程序实例对象\nconst app = getApp()\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    title: 'Index page',\n    userInfo: {},\n    currentPage: 0,\n    topics: []\n  },\n  /**\n   * 生命周期函数--监听页面加载\n   */\n  onLoad () {\n    console.log(' ---------- onLoad ----------')\n    // console.dir(app.data)\n    app.getUserInfo()\n      .then(info => this.setData({ userInfo: info }))\n      .catch(console.info)\n    this.fetchData()\n  },\n  /**\n   * 获取图片列表\n   * @return Array\n   */\n  fetchData () {\n    const self = this\n    const limit = 10\n    const start = self.data.currentPage * limit\n\n    wx.showLoading({\n      title: '害羞ing'\n    })\n    wx.request({\n      url: `https://haixiu.huangsy.me/api/topics?start=${start}&limit=${limit}`,\n      header: {\n        'content-type': 'application/json'\n      },\n      success: function (res) {\n        wx.hideLoading()\n        self.setData({\n          topics: res.data.docs\n        })\n      },\n      fail: function (err) {\n        wx.hideLoading()\n        wx.showToast({\n          title: '网络异常',\n          duration: 2000\n        })\n      }\n\n    })\n  },\n  fetchPre () {\n    const self = this\n    if(self.data.currentPage>0) {\n      self.setData({\n        currentPage: self.data.currentPage - 1\n      })\n      self.fetchData()\n    } \n  },\n  fetchNext () {\n    console.log('next')\n    const self = this\n    self.setData({\n      currentPage: self.data.currentPage + 1\n    })\n    self.fetchData()\n  },\n  /**\n   * 生命周期函数--监听页面初次渲染完成\n   */\n  onReady () {\n    console.log(' ---------- onReady ----------')\n  },\n  /**\n   * 生命周期函数--监听页面显示\n   */\n  onShow () {\n    console.log(' ---------- onShow ----------')\n  },\n  /**\n   * 生命周期函数--监听页面隐藏\n   */\n  onHide () {\n    console.log(' ---------- onHide ----------')\n  },\n  /**\n   * 生命周期函数--监听页面卸载\n   */\n  onUnload () {\n    console.log(' ---------- onUnload ----------')\n  },\n  /**\n   * 页面相关事件处理函数--监听用户下拉动作\n   */\n  onPullDownRefresh () {\n    console.log(' ---------- onPullDownRefresh ----------')\n  }\n})\n"]}